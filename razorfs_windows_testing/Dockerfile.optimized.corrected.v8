# Optimized RazorFS Testing Dockerfile - Corrected Version v8 (Final Debug)\n# Tests the new O(log n) performance improvements\n\nFROM ubuntu:22.04\nENV DEBIAN_FRONTEND=noninteractive\nENV TZ=UTC\nENV DOCKER_ENV=true\n\n# Install dependencies\nRUN apt-get update && apt-get install -y \\\n    build-essential \\\n    gcc \\\n    g++ \\\n    make \\\n    libfuse3-dev \\\n    fuse3 \\\n    e2fsprogs \\\n    btrfs-progs \\\n    reiserfsprogs \\\n    python3 \\\n    python3-pip \\\n    python3-matplotlib \\\n    python3-pandas \\\n    python3-seaborn \\\n    time \\\n    procps \\\n    util-linux \\\n    pkg-config \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Configure FUSE\nRUN echo 'user_allow_other' >> /etc/fuse.conf\n\n# Create directories\nRUN mkdir -p /results /mnt/ext4_test /mnt/btrfs_test /mnt/reiserfs_test /tmp/razor_mount\n\n# Debug: Check what's in the build context BEFORE setting workdir\nRUN echo \"=== BUILD CONTEXT DEBUG: Checking root directory ===\" && \\\n    ls -la / && \\\n    echo \"=== BUILD CONTEXT DEBUG: Checking if we can find Makefile from root ===\" && \\\n    find / -name \"Makefile\" -type f 2>/dev/null | head -10 || echo \"No Makefiles found in root search\"\n\n# Set working directory\nWORKDIR /razor_repo\n\n# Debug: Check current directory\nRUN echo \"=== WORKDIR DEBUG: Current directory ===\" && \\\n    pwd && \\\n    echo \"=== WORKDIR DEBUG: Directory contents ===\" && \\\n    ls -la . 2>/dev/null || echo \"Directory is empty or inaccessible\"\n\n# Copy files explicitly with debug\nCOPY Makefile /razor_repo/\nRUN echo \"=== COPY DEBUG: After copying Makefile ===\" && \\\n    ls -la Makefile 2>/dev/null || echo \"Makefile not found after copy\"\n\nCOPY src/ /razor_repo/src/\nRUN echo \"=== COPY DEBUG: After copying src ===\" && \\\n    ls -la src/ 2>/dev/null || echo \"src directory not found after copy\"\n\nCOPY tools/ /razor_repo/tools/\nRUN echo \"=== COPY DEBUG: After copying tools ===\" && \\\n    ls -la tools/ 2>/dev/null || echo \"tools directory not found after copy\"\n\nCOPY fuse/ /razor_repo/fuse/\nRUN echo \"=== COPY DEBUG: After copying fuse ===\" && \\\n    ls -la fuse/ 2>/dev/null || echo \"fuse directory not found after copy\"\n\nCOPY razorfs_windows_testing/ /razor_repo/razorfs_windows_testing/\nRUN echo \"=== COPY DEBUG: After copying razorfs_windows_testing ===\" && \\\n    ls -la razorfs_windows_testing/ 2>/dev/null || echo \"razorfs_windows_testing directory not found after copy\"\n\n# Comprehensive verification\nRUN echo \"=== COMPREHENSIVE VERIFICATION ===\" && \\\n    echo \"Current directory:\" && \\\n    pwd && \\\n    echo \"All files in current directory:\" && \\\n    ls -la && \\\n    echo \"Checking for Makefile:\" && \\\n    if [ -f \"Makefile\" ]; then \\\n        echo \"✅ Makefile found:\" && \\\n        ls -la Makefile; \\\n    else \\\n        echo \"❌ Makefile NOT found\"; \\\n        echo \"Searching for Makefile in subdirectories:\" && \\\n        find . -name \"Makefile\" -type f 2>/dev/null || echo \"No Makefiles found in search\"; \\\n    fi && \\\n    echo \"Checking directories:\" && \\\n    for dir in src tools fuse razorfs_windows_testing; do \\\n        if [ -d \"$dir\" ]; then \\\n            echo \"✅ $dir directory found\"; \\\n        else \\\n            echo \"❌ $dir directory NOT found\"; \\\n        fi; \\\n    done\n\n# Install Python dependencies\nRUN pip3 install pandas matplotlib seaborn\n\n# Try to build with error handling\nRUN echo \"=== BUILD ATTEMPT ===\" && \\\n    if [ -f \"Makefile\" ]; then \\\n        echo \"Attempting to build with Makefile...\" && \\\n        make clean 2>&1 || echo \"make clean failed, but continuing...\" && \\\n        make userspace 2>&1 || echo \"make userspace failed\"; \\\n    else \\\n        echo \"Cannot build - Makefile not found\"; \\\n        exit 1; \\\n    fi\n\n# Set entrypoint\nENTRYPOINT [\"/razor_repo/razorfs_windows_testing/optimized_filesystem_comparison.sh\"]